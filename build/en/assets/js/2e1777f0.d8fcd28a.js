"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[241],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),u=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(n),d=r,m=p["".concat(l,".").concat(d)]||p[d]||h[d]||o;return n?a.createElement(m,i(i({ref:t},c),{},{components:n})):a.createElement(m,i({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:r,i[1]=s;for(var u=2;u<o;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},7033:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>s,metadata:()=>u,toc:()=>p});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),i=["components"],s={id:"jwt",title:"JWT Signature"},l=void 0,u={unversionedId:"authentication/jwt",id:"authentication/jwt",title:"JWT Signature",description:"This authentication mode allows to automatically connect users to Logora once they are authenticated through your login system. This method uses a JWT token (JSON Web Token) with your secret key to convey the user's data to Logora.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/authentication/jwt.md",sourceDirName:"authentication",slug:"/authentication/jwt",permalink:"/en/authentication/jwt",draft:!1,tags:[],version:"current",frontMatter:{id:"jwt",title:"JWT Signature"},sidebar:"docs",previous:{title:"OAuth 2.0 server",permalink:"/en/authentication/oauth2_server"},next:{title:"Appearance and theme",permalink:"/en/configuration/theme"}},c={},p=[{value:"Before you start",id:"before-you-start",level:3},{value:"Authentication process",id:"authentication-process",level:3},{value:"Set up",id:"set-up",level:3},{value:"1. Generation of the JWT token",id:"1-generation-of-the-jwt-token",level:4},{value:"2. Transmission of the token to Logora",id:"2-transmission-of-the-token-to-logora",level:4},{value:"3. Disconnecting the user",id:"3-disconnecting-the-user",level:4},{value:"4. Redirection to the debate space after user login",id:"4-redirection-to-the-debate-space-after-user-login",level:4}],h={toc:p};function d(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"This authentication mode allows to automatically connect users to Logora once they are authenticated through your login system. This method uses a JWT token (JSON Web Token) with your secret key to convey the user's data to Logora."),(0,o.kt)("h3",{id:"before-you-start"},"Before you start"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Go to your ",(0,o.kt)("a",{parentName:"li",href:"https://admin.logora.fr"},"Administration space")," (",(0,o.kt)("em",{parentName:"li"},"Configuration > Authentication"),") to choose the authentication mode ",(0,o.kt)("inlineCode",{parentName:"li"},"JWT signature"),".  "),(0,o.kt)("li",{parentName:"ul"},"Get your API secret key. This secret key will be used to create the JWT token. It must be kept confidential.")),(0,o.kt)("h3",{id:"authentication-process"},"Authentication process"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"When the user connects to your website, you must create a JWT token containing the user's information. It will be transmitted to Logora. "),(0,o.kt)("li",{parentName:"ol"},"When the user goes to a page where the Logora code is inserted, the JWT token is inserted in the Javascript configuration variables, via the ",(0,o.kt)("inlineCode",{parentName:"li"},"remote_auth")," parameter."),(0,o.kt)("li",{parentName:"ol"},"The Logora application detects the JWT token, decodes it, verifies it and registers or connects the user.")),(0,o.kt)("h3",{id:"set-up"},"Set up"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"WARNING : the JWT token transmitted to Logora must always be updated according to the state of the user, whether they are connected or not. If the pages of your website are behind a cache, especially the pages that contain the debate summary, it is possible that the JWT token is not updated. If caching is interfering with the creation of the JWT token, use another authentication method.")),(0,o.kt)("h4",{id:"1-generation-of-the-jwt-token"},"1. Generation of the JWT token"),(0,o.kt)("p",null,"Using ",(0,o.kt)("a",{parentName:"p",href:"https://jwt.io/"},"JSON Web Token serialization"),", publishers can pass existing user data to provide users with a seamless authenticated session on Logora. The JWT token must be generated on your servers and then transmitted to Logora via javascript configuration variables. Here is the composition of the token, consisting of the following three parts:"),(0,o.kt)("p",null,"Token header"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'{ \n  "alg": "HS256", \n  "typ": "JWT" \n}\n')),(0,o.kt)("p",null,"Token body"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "uid": "12345abc",\n  "email": "jean@logora.fr",\n  "first_name": "Jean",\n  "last_name": "Dupont",\n  "iat": 1516239022\n}\n')),(0,o.kt)("p",null,"It must include the following case-sensitive attributes:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"uid"),": unique identifier associated with the user in your database."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"first_name"),": user's first name, or username if ",(0,o.kt)("inlineCode",{parentName:"li"},"last_name")," is empty."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"last_name")," (optional): the user's last name."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"email"),": the email address registered for this account."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"image_url")," (optional): link to the user's avatar."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"iat"),": date of generation of the JWT token")),(0,o.kt)("p",null,"Signature  "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'HMACSHA256(\n   base64UrlEncode(header) + "." +\n   base64UrlEncode(payload),\n   SECRET_KEY\n)\n')),(0,o.kt)("p",null,"Example in pseudo-code"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'header = { \n  "alg": "HS256", \n  "typ": "JWT" \n}\npayload = {\n  uid: "123abc",\n  first_name: "Jean",\n  last_name: "Dupont",\n  email: "jeandupont@exemple.com",\n  iat: 1516239022\n}\nsignature = HMACSHA256(\n   base64UrlEncode(header) + "." +\n   base64UrlEncode(payload),\n   SECRET_KEY\n)\n\n// Variable conveyed to Logora\ntokenJWT = base64UrlEncode(header) + "." + base64UrlEncode(payload) + "." + signature\n=> "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOiIxMjNhYmMiLCJmaXJzdF9uYW1lIjoiSmVhbiIsImxhc3RfbmFtZSI6IkR1cG9udCIsImVtYWlsIjoiamVhbmR1cG9udEBleGVtcGxlLmNvbSIsImlhdCI6MTUxNjIzOTAyMn0.ITnJo8VwbP4PkVTANSt651C0olsrdRNCNmvTHkanuYk"\n')),(0,o.kt)("h4",{id:"2-transmission-of-the-token-to-logora"},"2. Transmission of the token to Logora"),(0,o.kt)("p",null,"Once the message has been generated, it must be transmitted via the Javascript configuration variable, ",(0,o.kt)("inlineCode",{parentName:"p"},"remote_auth"),", in the debate space code."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"var logora_config = {\n    remote_auth: jeton_JWT\n}\n")),(0,o.kt)("h4",{id:"3-disconnecting-the-user"},"3. Disconnecting the user"),(0,o.kt)("p",null,"To disconnect the user, remove the ",(0,o.kt)("inlineCode",{parentName:"p"},"remote_auth")," parameter or transmit an empty string. If the parameter is empty, Logora considers that the user is disconnected."),(0,o.kt)("h4",{id:"4-redirection-to-the-debate-space-after-user-login"},"4. Redirection to the debate space after user login"),(0,o.kt)("p",null,"When a user who is not logged in wants to perform an action on the debate space, they are redirected to your login or registration page. When inserting the debate space and the overview, you must define the login and registration URLs via the auth.login_url and auth.registration_url variables respectively."),(0,o.kt)("p",null,"When redirecting, a logora_redirect request parameter is passed, containing the URL of the page before redirection. Use this parameter to redirect the user after their login or registration. The name of the parameter passed can be changed, it can be for example set to redirect_to. To change the parameter name, use the auth.redirectParameter variable."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},'var logora_config = {\n    remote_auth: jeton_JWT,\n    auth: {\n        login_url: "Your login URL",\n        registration_url: "You registration URL",\n        redirectParameter: "redirectTo"\n}\n')))}d.isMDXComponent=!0}}]);