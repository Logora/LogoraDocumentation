"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[952],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>v});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=u(n),m=a,v=d["".concat(s,".").concat(m)]||d[m]||p[m]||i;return n?r.createElement(v,o(o({ref:t},c),{},{components:n})):r.createElement(v,o({ref:t},c))}));function v(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:a,o[1]=l;for(var u=2;u<i;u++)o[u]=n[u];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},7482:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>m,frontMatter:()=>l,metadata:()=>u,toc:()=>d});var r=n(7462),a=n(3366),i=(n(7294),n(3905)),o=["components"],l={id:"jwt",title:"Signature JWT"},s=void 0,u={unversionedId:"authentication/jwt",id:"authentication/jwt",title:"Signature JWT",description:"Ce mode d'authentification permet de connecter automatiquement les utilisateurs \xe0 Logora une fois qu'il sont authentifi\xe9s \xe0 travers votre syst\xe8me de connexion. Cette m\xe9thode utilise un jeton JWT (JSON Web Token) par votre cl\xe9 secr\xe8te pour transmettre les donn\xe9es de l'utilisateur \xe0 Logora.",source:"@site/docs/authentication/jwt.md",sourceDirName:"authentication",slug:"/authentication/jwt",permalink:"/authentication/jwt",draft:!1,tags:[],version:"current",frontMatter:{id:"jwt",title:"Signature JWT"},sidebar:"docs",previous:{title:"Serveur OAuth 2.0",permalink:"/authentication/oauth2_server"},next:{title:"Apparence et th\xe8me",permalink:"/configuration/theme"}},c={},d=[{value:"Avant de commencer",id:"avant-de-commencer",level:3},{value:"Processus d&#39;authentification",id:"processus-dauthentification",level:3},{value:"Mise en place",id:"mise-en-place",level:3},{value:"1. G\xe9n\xe9ration du jeton JWT",id:"1-g\xe9n\xe9ration-du-jeton-jwt",level:4},{value:"2. Transmission du jeton \xe0 Logora",id:"2-transmission-du-jeton-\xe0-logora",level:4},{value:"3. D\xe9connexion de l&#39;utilisateur",id:"3-d\xe9connexion-de-lutilisateur",level:4},{value:"4. Redirection vers l&#39;espace de d\xe9bat apr\xe8s connexion de l&#39;utilisateur",id:"4-redirection-vers-lespace-de-d\xe9bat-apr\xe8s-connexion-de-lutilisateur",level:4}],p={toc:d};function m(e){var t=e.components,n=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Ce mode d'authentification permet de connecter automatiquement les utilisateurs \xe0 Logora une fois qu'il sont authentifi\xe9s \xe0 travers votre syst\xe8me de connexion. Cette m\xe9thode utilise un jeton JWT (JSON Web Token) par votre cl\xe9 secr\xe8te pour transmettre les donn\xe9es de l'utilisateur \xe0 Logora."),(0,i.kt)("h3",{id:"avant-de-commencer"},"Avant de commencer"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Rendez-vous sur votre ",(0,i.kt)("a",{parentName:"li",href:"https://admin.logora.fr"},"Espace d'administration")," onglet ",(0,i.kt)("em",{parentName:"li"},"Configuration > Authentification")," pour choisir le mode d'authentification ",(0,i.kt)("inlineCode",{parentName:"li"},"Signature JWT"),".  "),(0,i.kt)("li",{parentName:"ul"},"Munissez-vous de votre cl\xe9 secr\xe8te d'API. Cette cl\xe9 secr\xe8te vous servira \xe0 cr\xe9er le jeton JWT. Elle doit rester confidentielle. ")),(0,i.kt)("h3",{id:"processus-dauthentification"},"Processus d'authentification"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Lorsque l'utilisateur se connecte sur votre site web, vous devez cr\xe9er jeton JWT contenant les informations de l'utilisateur. Il sera transmis \xe0 Logora. "),(0,i.kt)("li",{parentName:"ol"},"Lorsque l'utilisateur se rend sur une page o\xf9 est ins\xe9r\xe9 le code Logora, le jeton JWT est ins\xe9r\xe9 dans les variables de configuration Javascript, via le param\xe8tre ",(0,i.kt)("inlineCode",{parentName:"li"},"remote_auth"),"."),(0,i.kt)("li",{parentName:"ol"},"L'application Logora d\xe9tecte le jeton JWT, le d\xe9code, le v\xe9rifie et inscrit ou connecte l'utilisateur.")),(0,i.kt)("h3",{id:"mise-en-place"},"Mise en place"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"ATTENTION : le jeton JWT transmis \xe0 Logora doit toujours \xeatre mis \xe0 jour selon l'\xe9tat de l'utilisateur, qu'il soit connect\xe9 ou non. Si les pages de votre site web sont derri\xe8re un cache, notamment les pages qui contiennent la synth\xe8se du d\xe9bat, il est possible que le jeton JWT ne soit pas mis \xe0 jour. Si la mise en cache g\xeane la cr\xe9ation du jeton JWT, utilisez une autre m\xe9thode d'authentification.")),(0,i.kt)("h4",{id:"1-g\xe9n\xe9ration-du-jeton-jwt"},"1. G\xe9n\xe9ration du jeton JWT"),(0,i.kt)("p",null,"Gr\xe2ce \xe0 la ",(0,i.kt)("a",{parentName:"p",href:"https://jwt.io/"},"s\xe9rialisation JSON Web Token"),", les \xe9diteurs peuvent transmettre les donn\xe9es utilisateurs existantes pour fournir aux utilisateurs une session authentifi\xe9e transparente sur Logora. Le jeton JWT doit \xeatre g\xe9n\xe9r\xe9 sur vos serveurs puis transmis \xe0 Logora via les variables de configuration javascript. Voici la composition du jeton, constitu\xe9 des trois parties suivantes :"),(0,i.kt)("p",null,"En-t\xeate du jeton"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'{ \n  "alg": "HS256", \n  "typ": "JWT" \n}\n')),(0,i.kt)("p",null,"Corps du jeton"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "uid": "12345abc",\n  "email": "jean@logora.fr",\n  "first_name": "Jean",\n  "last_name": "Dupont",\n  "iat": 1516239022\n}\n')),(0,i.kt)("p",null,"Il doit inclure les attributs suivants, sensibles \xe0 la casse :"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"uid")," : identifiant unique associ\xe9 \xe0 l'utilisateur dans votre base de donn\xe9es."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"first_name")," : pr\xe9nom de l'utilisateur, ou nom d'utilisateur si ",(0,i.kt)("inlineCode",{parentName:"li"},"last_name")," est vide."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"last_name")," (optionnel) : nom de famille de l'utilisateur."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"email")," : l'adresse email enregistr\xe9e pour ce compte."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"image_url")," (optionnel) : lien vers l'avatar de l'utilisateur."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"iat")," : date de g\xe9n\xe9ration du jeton JWT")),(0,i.kt)("p",null,"Signature  "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'HMACSHA256(\n   base64UrlEncode(header) + "." +\n   base64UrlEncode(payload),\n   SECRET_KEY\n)\n')),(0,i.kt)("p",null,"Exemple en pseudo-code"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'header = { \n  "alg": "HS256", \n  "typ": "JWT" \n}\npayload = {\n  uid: "123abc",\n  first_name: "Jean",\n  last_name: "Dupont",\n  email: "jeandupont@exemple.com",\n  iat: 1516239022\n}\nsignature = HMACSHA256(\n   base64UrlEncode(header) + "." +\n   base64UrlEncode(payload),\n   SECRET_KEY\n)\n\n// Variable transmise \xe0 Logora\njetonJWT = base64UrlEncode(header) + "." + base64UrlEncode(payload) + "." + signature\n=> "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOiIxMjNhYmMiLCJmaXJzdF9uYW1lIjoiSmVhbiIsImxhc3RfbmFtZSI6IkR1cG9udCIsImVtYWlsIjoiamVhbmR1cG9udEBleGVtcGxlLmNvbSIsImlhdCI6MTUxNjIzOTAyMn0.ITnJo8VwbP4PkVTANSt651C0olsrdRNCNmvTHkanuYk"\n')),(0,i.kt)("h4",{id:"2-transmission-du-jeton-\xe0-logora"},"2. Transmission du jeton \xe0 Logora"),(0,i.kt)("p",null,"Une fois que le message a \xe9t\xe9 g\xe9n\xe9r\xe9, il doit \xeatre transmis via la variable de configuration Javascript, ",(0,i.kt)("inlineCode",{parentName:"p"},"remote_auth"),", dans le code de l'espace de d\xe9bat."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"var logora_config = {\n    remote_auth: jeton_JWT\n}\n")),(0,i.kt)("h4",{id:"3-d\xe9connexion-de-lutilisateur"},"3. D\xe9connexion de l'utilisateur"),(0,i.kt)("p",null,"Pour d\xe9connecter l'utilisateur, retirez le param\xe8tre ",(0,i.kt)("inlineCode",{parentName:"p"},"remote_auth")," ou transmettez une cha\xeene de caract\xe8res vide. Si le param\xe8tre est vide, Logora consid\xe8re que l'utilisateur est d\xe9connect\xe9."),(0,i.kt)("h4",{id:"4-redirection-vers-lespace-de-d\xe9bat-apr\xe8s-connexion-de-lutilisateur"},"4. Redirection vers l'espace de d\xe9bat apr\xe8s connexion de l'utilisateur"),(0,i.kt)("p",null,"Lorsqu'un utilisateur non connect\xe9 veut effectuer une action sur l'espace de d\xe9bat, il est redirig\xe9 vers votre page de connexion ou d'inscription. Lors de l'insertion de l'espace de d\xe9bat et de la synth\xe8se, vous devez d\xe9finir les URLs de connexion et d'inscription, respectivement via les variables auth.login_url et auth.registration_url."),(0,i.kt)("p",null,"Lors de la redirection, un param\xe8tre de requ\xeate logora_redirect est transmis, contenant l'URL de la page avant redirection. Utilisez ce param\xe8tre pour rediriger l'utilisateur apr\xe8s sa connexion ou son inscription. Le nom du param\xe8tre transmis peut \xeatre modifi\xe9, il peut \xeatre par exemple d\xe9fini \xe0 redirect_to. Pour changer le nom du param\xe8tre, utilisez la variable auth.redirectParameter."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'var logora_config = {\n    remote_auth: jeton_JWT,\n    auth: {\n        login_url: "Votre URL de connexion",\n        registration_url: "Votre URL d\'inscription",\n        redirectParameter: "redirectTo"\n}\n')))}m.isMDXComponent=!0}}]);